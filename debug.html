<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞ –∏–≥—Ä—ã</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: white;
        }
        
        .error {
            background: #5a2d2d;
            border: 2px solid #f44336;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .success {
            background: #2d5a2d;
            border: 2px solid #4CAF50;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .log {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <h1>üîß –û—Ç–ª–∞–¥–∫–∞ –∏–≥—Ä—ã</h1>
    
    <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    
    <div id="log" class="log"></div>

    <script>
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
        window.addEventListener('error', function(e) {
            showError('JavaScript Error', e.error || e.message, e.filename, e.lineno);
        });
        
        window.addEventListener('unhandledrejection', function(e) {
            showError('Promise Rejection', e.reason, 'Promise', 0);
        });
        
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.style.color = type === 'error' ? '#ff6b6b' : type === 'warn' ? '#ffa726' : '#4caf50';
            entry.textContent = `[${timestamp}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(message);
        }
        
        function showError(title, error, filename, lineno) {
            const statusDiv = document.getElementById('status');
            statusDiv.className = 'error';
            statusDiv.innerHTML = `
                <h2>‚ùå ${title}</h2>
                <p><strong>–û—à–∏–±–∫–∞:</strong> ${error}</p>
                <p><strong>–§–∞–π–ª:</strong> ${filename}</p>
                <p><strong>–°—Ç—Ä–æ–∫–∞:</strong> ${lineno}</p>
                <pre>${error.stack || 'Stack trace –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω'}</pre>
            `;
            
            log(`ERROR: ${title} - ${error}`, 'error');
        }
        
        function showSuccess(message) {
            const statusDiv = document.getElementById('status');
            statusDiv.className = 'success';
            statusDiv.innerHTML = `<h2>‚úÖ ${message}</h2>`;
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π
        async function testModules() {
            try {
                log('–ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π...');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–æ–≤
                log('–ü—Ä–æ–≤–µ—Ä—è–µ–º LanguageManager...');
                if (typeof LanguageManager === 'undefined') {
                    throw new Error('LanguageManager –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                log('‚úÖ LanguageManager –¥–æ—Å—Ç—É–ø–µ–Ω');
                
                log('–ü—Ä–æ–≤–µ—Ä—è–µ–º DataManager...');
                if (typeof DataManager === 'undefined') {
                    throw new Error('DataManager –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                log('‚úÖ DataManager –¥–æ—Å—Ç—É–ø–µ–Ω');
                
                log('–ü—Ä–æ–≤–µ—Ä—è–µ–º CategoryManager...');
                if (typeof CategoryManager === 'undefined') {
                    throw new Error('CategoryManager –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                log('‚úÖ CategoryManager –¥–æ—Å—Ç—É–ø–µ–Ω');
                
                log('–ü—Ä–æ–≤–µ—Ä—è–µ–º GameEngine...');
                if (typeof GameEngine === 'undefined') {
                    throw new Error('GameEngine –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                log('‚úÖ GameEngine –¥–æ—Å—Ç—É–ø–µ–Ω');
                
                // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä—ã
                log('–°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä—ã...');
                const languageManager = new LanguageManager();
                log('‚úÖ LanguageManager —Å–æ–∑–¥–∞–Ω');
                
                const dataManager = new DataManager();
                log('‚úÖ DataManager —Å–æ–∑–¥–∞–Ω');
                
                const categoryManager = new CategoryManager(dataManager, languageManager);
                log('‚úÖ CategoryManager —Å–æ–∑–¥–∞–Ω');
                
                // –î–ª—è GameEngine –Ω—É–∂–µ–Ω canvas
                const canvas = document.createElement('canvas');
                canvas.id = 'gameCanvas';
                canvas.width = 600;
                canvas.height = 400;
                document.body.appendChild(canvas);
                
                const gameEngine = new GameEngine(dataManager, languageManager, categoryManager);
                log('‚úÖ GameEngine —Å–æ–∑–¥–∞–Ω');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º LanguageManager...');
                await languageManager.initialize();
                log('‚úÖ LanguageManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º DataManager...');
                await dataManager.loadConfig();
                log('‚úÖ DataManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º CategoryManager...');
                await categoryManager.initialize();
                log('‚úÖ CategoryManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º GameEngine...');
                await gameEngine.initialize();
                log('‚úÖ GameEngine –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                showSuccess('–í—Å–µ –º–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!');
                
                // –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π canvas
                document.body.removeChild(canvas);
                
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', error.message, 'debug.html', 0);
                console.error('–ü–æ–ª–Ω–∞—è –æ—à–∏–±–∫–∞:', error);
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
        window.addEventListener('load', () => {
            log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            setTimeout(testModules, 100); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π
        });
    </script>
    
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, —á—Ç–æ –∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–µ -->
    <script src="modules/LanguageManager.js"></script>
    <script src="modules/DataManager.js"></script>
    <script src="modules/CategoryManager.js"></script>
    <script src="modules/GameEngine.js"></script>
</body>
</html> 