<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–¥—É–ª—å–Ω–∞—è –∏–≥—Ä–∞ –≤ —Å–ª–æ–≤–∞</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 
    –ì–õ–ê–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï - –ú–û–î–£–õ–¨–ù–ê–Ø –ò–ì–†–ê –í –°–õ–û–í–ê
    
    –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
    1. –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏ —è–∑—ã–∫–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ä–∞—Å–∫–ª–∞–¥–∫–∏
    2. –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å —Å canvas –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–≥—Ä—ã
    3. –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    4. –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
    
    –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
    - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 3 —è–∑—ã–∫–æ–≤ (—Ä—É—Å—Å–∫–∏–π, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, –∏—Å–ø–∞–Ω—Å–∫–∏–π)
    - 9 —Ä–∞—Å–∫–ª–∞–¥–æ–∫ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (QWERTY, Dvorak, Colemak –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞)
    - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    - –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ES6
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ data-i18n –∞—Ç—Ä–∏–±—É—Ç—ã
    -->
    <div id="app">
        <!-- –ì–õ–ê–í–ù–ê–Ø –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
        <!-- –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–π -->
        <div id="mainControls" class="main-controls">
            <!-- –ì–†–£–ü–ü–ê –°–ï–õ–ï–ö–¢–û–†–û–í -->
            <!-- –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å —è–∑—ã–∫, –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ —Ä–∞—Å–∫–ª–∞–¥–∫—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã -->
            <div class="selectors-group">
                <!-- –°–µ–ª–µ–∫—Ç–æ—Ä —è–∑—ã–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –∏–≥—Ä—ã -->
                <div class="selector-item">
                    <label for="languageSelect" data-i18n="selectLanguage">–Ø–∑—ã–∫:</label>
                    <div id="languageContainer"></div>
                </div>
                
                <!-- –°–µ–ª–µ–∫—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–ª–æ–≤ –¥–ª—è –∏–≥—Ä—ã -->
                <div class="selector-item">
                    <label for="categorySelect" data-i18n="selectCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                    <div id="categoryContainer"></div>
                </div>
                
                <!-- –°–µ–ª–µ–∫—Ç–æ—Ä —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ) -->
                <div class="selector-item">
                    <label for="keyboardLayoutSelect" data-i18n="selectKeyboardLayout">–†–∞—Å–∫–ª–∞–¥–∫–∞:</label>
                    <div id="keyboardLayoutContainer"></div>
                </div>
            </div>
            
            <!-- –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ò–ì–†–û–ô -->
            <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è: —Å—Ç–∞—Ä—Ç, –ø–∞—É–∑–∞, —Å—Ç–æ–ø, –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
            <div class="game-controls">
                <button id="startButton">‚ñ∂</button>
                <button id="pauseButton">‚è∏</button>
                <button id="stopButton">‚èπ</button>
                <!-- <button id="adminButton" data-i18n="admin">–ê–¥–º–∏–Ω</button> -->
            </div>
        </div>

        <!-- –ò–ì–†–û–í–ê–Ø –û–ë–õ–ê–°–¢–¨ -->
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∑–æ–Ω–∞ –∏–≥—Ä—ã —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Å—á–µ—Ç–∞ –∏ canvas –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ -->
        <div id="gameContainer">
            <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—á–µ—Ç–∞ –∏ —É—Ä–æ–≤–Ω—è -->
            <div id="score" data-i18n="score">–û—á–∫–∏: 0 (–£—Ä–æ–≤–µ–Ω—å 1)</div>
            <!-- Canvas –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∏–≥—Ä–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–ø–∞–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) -->
            <canvas id="gameCanvas"></canvas>
        </div>

        <!-- –í–ò–†–¢–£–ê–õ–¨–ù–ê–Ø –ö–õ–ê–í–ò–ê–¢–£–†–ê -->
        <!-- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
        <!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –∏ —Ä–∞—Å–∫–ª–∞–¥–∫—É -->
        <div id="keyboard"></div>

        <!-- –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê - –í–†–ï–ú–ï–ù–ù–û –û–¢–ö–õ–Æ–ß–ï–ù–ê -->
        <!-- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –ø–∞–ø–∫—É admin_panel_docs/ -->
        <!--
        <div id="adminPanel" class="admin-panel" style="display: none;">
            <div class="admin-header">
                <h2 data-i18n="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
                <button id="backToGameButton" data-i18n="backToGame">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∏–≥—Ä–µ</button>
            </div>
            
            <div class="admin-form">
                <div class="form-group">
                    <label for="newCategoryName" data-i18n="categoryName">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:</label>
                    <input type="text" id="newCategoryName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏">
                </div>

                <div class="form-group">
                    <label for="categoryLanguage" data-i18n="selectLanguage">–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:</label>
                    <select id="categoryLanguage"></select>
                </div>

                <div class="form-group">
                    <label for="wordsFile" data-i18n="uploadWords">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª —Å–æ —Å–ª–æ–≤–∞–º–∏:</label>
                    <input type="file" id="wordsFile" accept=".txt">
                    <small>–§–æ—Ä–º–∞—Ç: 1 - –°–ª–æ–≤–æ</small>
                </div>

                <div class="form-group">
                    <label for="imagesFiles" data-i18n="uploadImages">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
                    <input type="file" id="imagesFiles" accept=".png,.jpg,.jpeg" multiple>
                    <small>–ù–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–æ–º–µ—Ä–∞–º –≤ —Ñ–∞–π–ª–µ —Å–ª–æ–≤</small>
                </div>

                <div class="form-actions">
                    <button id="validateButton" data-i18n="validate">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <button id="saveButton" data-i18n="save" disabled>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>

                <div id="validationResult" class="validation-result" style="display: none;">
                    <h3 data-i18n="validationResult">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:</h3>
                    <div id="validationDetails"></div>
                </div>
            </div>
        </div>
        -->
    </div>

    <!-- –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ú–û–î–£–õ–ï–ô -->
    <!-- –ü–æ—Ä—è–¥–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–∞–∂–µ–Ω –∏–∑-–∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏ -->
    <script src="modules/LanguageManager.js"></script>    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞–º–∏ –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–µ–π -->
    <script src="modules/DataManager.js"></script>        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ -->
    <script src="modules/CategoryManager.js"></script>    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ -->
    <script src="modules/GameEngine.js"></script>         <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ -->
    <!-- <script src="modules/AdminPanel.js"></script>         –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ - –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞ -->
    
    <!-- –û–°–ù–û–í–ù–û–ô –°–ö–†–ò–ü–¢ –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø -->
    <!-- –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å App –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π -->
    <script>
        /**
         * –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
         * –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
         * 
         * –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
         * - –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –≤—Å–µ—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
         * - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Ö –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
         * - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
         * - –£–ø—Ä–∞–≤–ª—è–µ—Ç UI –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–æ–±—ã—Ç–∏–π
         */
        class App {
            constructor() {
                // –≠–∫–∑–µ–º–ø–ª—è—Ä—ã –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                this.languageManager = null;    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞–º–∏ –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–µ–π
                this.dataManager = null;        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                this.categoryManager = null;    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ —Å–ª–æ–≤
                this.gameEngine = null;         // –û—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
                // this.adminPanel = null;         // –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ - –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞
                
                // –§–ª–∞–≥ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                this.isInitialized = false;
            }

            async initialize() {
                try {
                    console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
                    this.languageManager = new LanguageManager();
                    this.dataManager = new DataManager();
                    this.categoryManager = new CategoryManager(this.dataManager, this.languageManager);
                    this.gameEngine = new GameEngine(this.dataManager, this.languageManager, this.categoryManager);
                    // this.adminPanel = new AdminPanel(this.dataManager, this.languageManager, this.categoryManager);

                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π
                    await this.languageManager.initialize();
                    await this.dataManager.loadConfig();
                    await this.categoryManager.initialize();
                    await this.gameEngine.initialize();
                    // await this.adminPanel.initialize();

                    // –°–æ–∑–¥–∞–Ω–∏–µ UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                    this.setupUI();
                    
                    // –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                    this.languageManager.localizeDOM();
                    
                    this.isInitialized = true;
                    console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error);
                    this.showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
                }
            }

            setupUI() {
                // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —è–∑—ã–∫–æ–≤
                this.languageManager.createLanguageSelector('languageContainer', (newLanguage) => {
                    console.log(`–Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${newLanguage}`);
                    
                    // üõë –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –ò–ì–†–£ –ü–†–ò –°–ú–ï–ù–ï –Ø–ó–´–ö–ê
                    if (this.gameEngine.isGameActive()) {
                        this.gameEngine.stopGame();
                        console.log('–ò–≥—Ä–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ —è–∑—ã–∫–∞');
                    }
                    
                    this.updateCategorySelector();
                    this.updateKeyboardLayoutSelector();
                    // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –Ω–æ–≤–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–æ–π
                    this.languageManager.createMobileKeyboard('keyboard', (key) => {
                        if (this.gameEngine.isGameActive()) {
                            this.gameEngine.handleKeyPress(key);
                        }
                    });
                });

                // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
                this.updateCategorySelector();

                // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
                this.updateKeyboardLayoutSelector();

                // –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
                this.languageManager.createMobileKeyboard('keyboard', (key) => {
                    if (this.gameEngine.isGameActive()) {
                        this.gameEngine.handleKeyPress(key);
                    }
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ - –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã
                /*
                document.getElementById('adminButton').addEventListener('click', () => {
                    this.showAdminPanel();
                });

                document.getElementById('backToGameButton').addEventListener('click', () => {
                    this.hideAdminPanel();
                });
                */

                // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–∞–Ω–≤–∞—Å–∞
                this.resizeCanvas();
                window.addEventListener('resize', () => this.resizeCanvas());
            }

            updateCategorySelector() {
                const container = document.getElementById('categoryContainer');
                if (!container) return;

                // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                container.innerHTML = '';

                // –°–æ–∑–¥–∞–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä
                const select = document.createElement('select');
                select.id = 'categorySelect';
                select.className = 'category-select';

                // –ü—É—Å—Ç–∞—è –æ–ø—Ü–∏—è
                const emptyOption = document.createElement('option');
                emptyOption.value = '';
                emptyOption.textContent = this.languageManager.getText('selectCategory') || '–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é';
                select.appendChild(emptyOption);

                // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                const categories = this.dataManager.getCategories();
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.id;
                    const currentLang = this.languageManager.getCurrentLanguage();
                    option.textContent = category.names[currentLang] || category.names.ru || category.id;
                    select.appendChild(option);
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è
                select.addEventListener('change', async (e) => {
                    const categoryId = e.target.value;
                    if (categoryId) {
                        const currentLang = this.languageManager.getCurrentLanguage();
                        const success = await this.categoryManager.setCategory(categoryId, currentLang);
                        console.log(`–ö–∞—Ç–µ–≥–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞: ${categoryId}, —É—Å–ø–µ—Ö: ${success}`);
                    } else {
                        this.categoryManager.reset();
                    }
                });

                container.appendChild(select);
            }

            updateKeyboardLayoutSelector() {
                const container = document.getElementById('keyboardLayoutContainer');
                if (!container) return;

                // –°–æ–∑–¥–∞–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
                const selector = this.languageManager.createKeyboardLayoutSelector('keyboardLayoutContainer', (newLayout) => {
                    console.log(`–†–∞—Å–∫–ª–∞–¥–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞: ${newLayout}`);
                    // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –º–æ–±–∏–ª—å–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –Ω–æ–≤–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–æ–π
                    this.languageManager.createMobileKeyboard('keyboard', (key) => {
                        if (this.gameEngine.isGameActive()) {
                            this.gameEngine.handleKeyPress(key);
                        }
                    });
                });

                // –ï—Å–ª–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω (—Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ä–∞—Å–∫–ª–∞–¥–∫–∞), 
                // —É–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤—Å–µ —Ä–∞–≤–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
                if (!selector) {
                    this.languageManager.createMobileKeyboard('keyboard', (key) => {
                        if (this.gameEngine.isGameActive()) {
                            this.gameEngine.handleKeyPress(key);
                        }
                    });
                }
            }

            // –ú–µ—Ç–æ–¥—ã –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ - –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã
            /*
            showAdminPanel() {
                document.getElementById('adminPanel').style.display = 'block';
                document.body.style.overflow = 'hidden'; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª —Ñ–æ–Ω–∞
            }

            hideAdminPanel() {
                document.getElementById('adminPanel').style.display = 'none';
                document.body.style.overflow = 'auto'; // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∫—Ä–æ–ª–ª
            }
            */

            resizeCanvas() {
                const canvas = document.getElementById('gameCanvas');
                const mainControls = document.getElementById('mainControls');
                if (!canvas) return;

                // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ - –ø–æ–ª–∞–≥–∞–µ–º—Å—è –Ω–∞ CSS —Å—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
                const isMobile = window.innerWidth <= 480;
                const isSmallMobile = window.innerWidth <= 360;
                const isDesktop = window.innerWidth >= 1200;
                
                let canvasWidth, canvasHeight;
                
                if (isDesktop) {
                    // –î–µ—Å–∫—Ç–æ–ø - –±–æ–ª—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
                    canvasWidth = Math.min(window.innerWidth * 0.8, 1200);
                    canvasHeight = Math.min(window.innerHeight * 0.7, 900);
                } else if (isMobile) {
                    // –ú–æ–±–∏–ª—å–Ω—ã–µ - –∏—Å–ø–æ–ª—å–∑—É–µ–º CSS max-height –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –º–µ—Å—Ç–∞
                    canvasWidth = Math.min(window.innerWidth * 0.95, 600);
                    
                    // –í—ã—Å–æ—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è CSS —Å—Ç–∏–ª—è–º–∏ —Å —É—á–µ—Ç–æ–º –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                    const reservedHeight = isSmallMobile ? 140 : 150;
                    canvasHeight = Math.min(window.innerHeight - reservedHeight, 500);
                } else {
                    // –ü–ª–∞–Ω—à–µ—Ç—ã
                    canvasWidth = Math.min(window.innerWidth * 0.9, 800);
                    canvasHeight = Math.min(window.innerHeight * 0.6, 600);
                }
                
                // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
                canvasWidth = Math.max(isMobile ? 280 : 400, canvasWidth);
                canvasHeight = Math.max(isMobile ? 200 : 300, canvasHeight);
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã
                canvas.width = canvasWidth;
                canvas.height = canvasHeight;
                canvas.style.width = canvasWidth + 'px';
                canvas.style.height = canvasHeight + 'px';
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —à–∏—Ä–∏–Ω—É –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å canvas
                if (mainControls) {
                    mainControls.style.maxWidth = canvasWidth + 'px';
                    mainControls.style.width = canvasWidth + 'px';
                }
                
                console.log(`Canvas resized to ${canvasWidth}x${canvasHeight} for screen ${window.innerWidth}x${window.innerHeight}, mobile: ${isMobile}, small: ${isSmallMobile}`);
                
                // –£–≤–µ–¥–æ–º–ª—è–µ–º –∏–≥—Ä–æ–≤–æ–π –¥–≤–∏–∂–æ–∫ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
                if (this.gameEngine && this.gameEngine.handleResize) {
                    this.gameEngine.handleResize(canvasWidth, canvasHeight);
                }
            }

            showError(message) {
                alert(message); // –ü—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const app = new App();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
        async function initializeApp() {
            try {
                await app.initialize();
            } catch (error) {
                console.error('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                document.body.innerHTML = `
                    <div style="color: white; background: #1a1a1a; padding: 20px; font-family: Arial;">
                        <h1 style="color: #f44336;">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã</h1>
                        <p><strong>–û—à–∏–±–∫–∞:</strong> ${error.message}</p>
                        <p><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π</strong></p>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (Ctrl+F5)</p>
                    </div>
                `;
            }
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
    </script>
</body>
</html> 